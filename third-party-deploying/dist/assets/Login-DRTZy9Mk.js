import{r as u,c as d,a as e,w as m,v as _,b as y,d as w,o as c}from"./index-C3hUR6oy.js";import{C as b,u as g}from"./UserNameStore-_yaaHiFe.js";import{i as S}from"./index-Dz2eRhrO.js";const k={class:"login"},L=e("h1",null,"Login",-1),x={class:"input-container"},P=e("label",{for:"email"},"Email",-1),T={class:"input-container"},U=e("label",{for:"password"},"Password",-1),V=["disabled"],$={key:0},q={key:1},N={__name:"Login",setup(B){const r=u(""),n=u(""),o=u(!1),f=async()=>{o.value=!0;const p="/api/v1/auth/login",s={email:r.value,password:n.value},t=new Headers;t.append("Content-Type","application/json");const h={method:"POST",headers:t,body:JSON.stringify(s),redirect:"follow"};try{const a=await fetch(p,h),l=await a.json();if(a.ok){const i={username:l.user.name,userId:l.user.userId,role:l.user.role};g().setUser(i),S("Successfully logged in",{theme:"auto",type:"success",position:"top-center",dangerouslyHTMLString:!0});const v=$route.query.redirect||"/protected";$router.push(v)}else{const i=$route.query.redirect||"/failed";$router.push(i)}}catch(a){console.error(a)}finally{o.value=!1}};return(p,s)=>(c(),d("div",k,[e("form",{class:"form",onSubmit:w(f,["prevent"])},[L,e("div",x,[P,m(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>r.value=t),name:"email",type:"text",class:"input","aria-labelledby":"email"},null,512),[[_,r.value]])]),e("div",T,[U,m(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>n.value=t),name:"password",type:"password",class:"input","aria-labelledby":"password"},null,512),[[_,n.value]])]),e("button",{class:"btn",disabled:o.value},[o.value?(c(),d("span",$,[y(b)])):(c(),d("span",q," Login "))],8,V)],32)]))}};export{N as default};
